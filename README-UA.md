AI Асистент для LibreOffice Writer на базі Gemini
Цей скрипт інтегрує Google Gemini API в LibreOffice Writer, дозволяючи вам редагувати та генерувати текст безпосередньо в документі за допомогою зручного діалогового вікна.

Можливості
Пряма інтеграція з Gemini: Надсилайте запити до AI, не залишаючи текстового редактора.

Робота з виділеним текстом: Скрипт автоматично підхоплює виділений вами текст і додає його до контексту запиту.

Шаблони запитів: Використовуйте випадаючий список із готовими командами («Покращ текст», «Скороти текст» тощо).

Кастомні запити: Вводьте власні, детальні промпти в текстове поле.

Зручний запуск: Запускайте скрипт за допомогою кнопки на панелі інструментів або гарячої клавіші.

Вимоги
LibreOffice 7.0 або новіша версія.

Python 3.8+ (зазвичай встановлюється разом із LibreOffice).

API-ключ від Google Gemini. Отримати його можна безкоштовно в Google AI Studio.

Встановлення та налаштування
Виконайте ці кроки, щоб налаштувати скрипт.

Крок 1: Встановлення бібліотеки Google
Це найважливіший крок. Вам потрібно встановити Python-бібліотеку google-generativeai у середовище, яке використовує LibreOffice.

Знайдіть файл python.exe вашого LibreOffice.

Windows: C:\Program Files\LibreOffice\program\python.exe

Linux: /usr/lib/libreoffice/program/python

Відкрийте термінал (командний рядок) з правами адміністратора.

Windows: Натисніть Win+X і виберіть "Термінал (Адміністратор)" або "Windows PowerShell (Адміністратор)".

Linux: Відкрийте термінал і виконайте команду з sudo.

Виконайте команду встановлення, вказавши повний шлях до python.exe в лапках:

Bash

# Приклад для Windows
"C:\Program Files\LibreOffice\program\python.exe" -m pip install google-generativeai

# Приклад для Linux
sudo /usr/lib/libreoffice/program/python -m pip install google-generativeai
Крок 2: Додавання скрипту в LibreOffice
Скопіюйте весь код зі скрипту.

Відкрийте LibreOffice Writer.

Перейдіть у меню Сервіс → Макроси → Упорядкувати макроси → Python....

Ліворуч виберіть Мої макроси → Standard. Якщо папки Standard не існує, створіть її.

Натисніть Створити, введіть назву для файлу (наприклад, gemini_assistant) і натисніть OK.

Відкриється текстовий редактор. Видаліть увесь існуючий код і вставте скопійований вами код скрипту.

Збережіть файл (Ctrl+S) і закрийте редактор.

Крок 3: Конфігурація скрипту
У тому ж редакторі макросів знайдіть на початку коду секцію КОНФІГУРАЦІЯ.

Замініть "Your_API_key" на ваш справжній API-ключ.

Переконайтеся, що назва моделі AI_MODEL є актуальною (наприклад, "gemini-1.5-flash-latest").

Python

# --- КОНФІГУРАЦІЯ ---
API_KEY = "ВАШ-СПРАВЖНІЙ-API-КЛЮЧ-ВІД-GOOGLE"
AI_MODEL = "gemini-1.5-flash-latest"
Крок 4: Створення кнопки на панелі інструментів (Рекомендовано)
Перейдіть у Сервіс → Налаштувати... та відкрийте вкладку Панелі інструментів.

Створіть нову панель (наприклад, "AI Tools").

Натисніть Додати... і в Категорії виберіть LibreOffice Macros.

Знайдіть ваш скрипт: My Macros → Standard → gemini_assistant → generate_text_with_ai.

Додайте його.

За бажанням, натисніть Змінити та виберіть для кнопки гарний значок.

Натисніть ОК, щоб зберегти зміни.

Використання
Відкрийте документ у LibreOffice Writer.

Виділіть текст, який хочете відредагувати (необов'язково).

Натисніть на створену кнопку на панелі інструментів.

У діалоговому вікні, що з'явилося:

Виберіть готову дію з випадаючого списку.

Або/та введіть свій детальний запит у текстове поле.

Натисніть ОК або клавішу Enter.

Зачекайте на відповідь. Виділений текст буде замінено на результат від Gemini. Якщо текст не було виділено, результат вставиться на місце курсора.

Ліцензія
Цей проект розповсюджується за ліцензією MIT. Детальніше див. у файлі LICENSE.
